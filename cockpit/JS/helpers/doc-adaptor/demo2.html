<html>
  <head>
    <title>WfAdaptor Demo</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <script type="text/javascript" src="../jquery.min.js"></script>
    <script type="text/javascript" src="../jquery.svgdom.js"></script>
    <script type="text/javascript" src="../underscore.min.js"></script>
    <script type="text/javascript" src="../../wfadaptor.js"></script>
    <script type="text/javascript" src="../../wfadaptor.cpee.js"></script>
    <script type="text/javascript" src="../../graph.js"></script>
    <link rel="stylesheet" href="../../wfadaptor.css" type="text/css"/>
    <script type="text/javascript">
      var adaptor = null;
      var parser = DOMParser();
      function click_update_graph() {
        console.log("Demo: Graph Update");
        var then = new Date();
        adaptor.set_description($('#description').val());
        $('#t_new').text((new Date()).getTime() - then.getTime() + 'ms'); 
      }
      function update_event(element_id, operation) {
        console.log("Demo: update notification [ID: "+element_id+ ", OP: "+operation+"]");
      }
    </script>
  </head>
  <body>
    <table style="background: ThreeDShadow; width: 100%; height: 100%;" border="0">
      <tr>
        <td style="text-align:center; vertical-align:middle"><button type="button" onclick="click_update_graph();">Update Graph &gt;&gt;&gt; </button></td>
        <td style="text-align:center; vertical-align:middle" colspan="2"><b><font size="+2">Workflow Graph</font></b></td>
      </tr>
      <tr height="95%">
        <td width="40%" style="vertical-align:middle; text-align:center"><!-- {{{ -->
          <textarea style="width:98%;height:98%" id="description">
<description xmlns="http://cpee.org/ns/description/1.0">
  <call/>
  <choose>
    <alternative>
      <call/>
    </alternative>
    <alternative>
      <call/>
    </alternative>
  </choose>
</description>
          </textarea>
        </td><!-- }}} --> 
        <td style="vertical-align: top"><!-- {{{ -->
          <h3>New Graph Version -> Built-Time:<span id="t_new">00</span></h3>
          <svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="600" width="300" xmlns:xlink="http://www.w3.org/1999/xlink" id="drawing_area">
          </svg>
        </td><!-- }}} -->
      </tr>
    </table>
    <script type="text/javascript">
      var then = new Date();
      adaptor = new WfAdaptor();
      var cpee = create_cpee_elements(adaptor.illustrator);
      adaptor.set_svg_container($('#drawing_area'));
      adaptor.add_elements(cpee);
      adaptor.set_description($('#description').val());
                                    
      $('#t_new').text((new Date()).getTime() - then.getTime() + 'ms'); 
      adaptor.notify = update_event;
      adaptor.notify('none','test call from demo');
      //console.log(adaptor.get_description());
    </script>
  </body>
</html>
