<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <head>
    <title>WEE - Index</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <link rel="stylesheet" href="index.css" type="text/css"/>
    <script src="http://jqueryjs.googlecode.com/files/jquery-1.3.2.min.js" type="text/javascript"></script>
  </head>
  <body>
    <script type="text/javascript">
        function makeFlightInstance() {
            // Fetch the url of the wee-riddle
            $.ajax({
              type: "GET", cache: false,
              url: "remote",
              success: function(wee_url){
                // create a new instance and add a link
                console.log("calling: "+wee_url);
                makeRequest("POST", wee_url, new_instance_created, report_failure);
                
              }
            });            
        }
        function new_instance_created(instance_id) {
            console.info("Adding Instance "+instance_id);
            $("#div_instances").append("<a href=\""+instance_id+"\" style=\"display:block\">Go to Instance "+instance_id+"</a>");
        }
        function report_failure(text) {
            console.log("ERROR: "+text);
        }
        function makeRequest(method, url, success, failure) {
            var req = new XMLHttpRequest();  
            var ret = "";
            req.open(method, url, true);  
            req.onreadystatechange = function (e) {  
                if (req.readyState === 4) {  
                    if(req.status === 200) {
                        success(req.responseText);
                    } else {  
                        failure("method "+method+" to "+url+" failed");
                    }
                    method
                }  
            };  
            req.send(null);
        }

    </script>
    <h1>WorkflowExecutionEngine - Demo</h1>
    <table>
        <tr>
            <td valign="top">
                Book Flight & Hotel
            </td>
            <td>
                <button type="button" id="btn_book" onclick="makeFlightInstance()">New Instance</button>
                <div id="div_instances"></div>
            </td>
        </tr>
        <tr>
            <td valign="top">

                Pay Wages
            </td>
            <td>
                <button type="button" id="btn_book">New Instance</button>
            </td>
        </tr>
        <tr>
            <td valign="top">
                New Customer Order
            </td>
            <td>
                <button type="button" id="btn_book">New Instance</button>
            </td>
        </tr>
    </table>
    <textarea id="txt_log" cols="100" rows="20">Log</textarea>
  </body>
</html>
